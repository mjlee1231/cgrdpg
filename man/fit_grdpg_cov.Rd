% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit.R
\name{fit_grdpg_cov}
\alias{fit_grdpg_cov}
\title{Fit GRDPG with contextual covariates via Fisher scoring}
\usage{
fit_grdpg_cov(
  A,
  B,
  d,
  p = NULL,
  q = NULL,
  tau = 0.05,
  maxit = 5,
  tol = 0.01,
  ridge = 0
)
}
\arguments{
\item{A}{(n x n) symmetric adjacency matrix with entries in {0,1}.}

\item{B}{(p_cov x n) covariate matrix arranged as features-by-nodes.}

\item{d}{embedding dimension (d = p + q).}

\item{p}{number of positive signature directions. If \code{NULL}, estimated.}

\item{q}{number of negative signature directions. If \code{NULL}, taken as \code{d-p}.}

\item{tau}{smoothing threshold in (0, 1/2). Default 0.05.}

\item{maxit}{maximum number of Fisher-scoring sweeps. Default 5.}

\item{tol}{stopping tolerance on the maximum row change of X. Default 1e-2.}

\item{ridge}{small ridge inside linear solves. Default 0.}
}
\value{
a list with \code{X}, \code{Z}, \code{Y}, \code{p}, \code{q}, \code{tau},
\code{converged}, \code{iters}, and \code{history}.
}
\description{
Fit GRDPG with contextual covariates via Fisher scoring
}
\details{
Dimension consistency (p + q == d) is validated internally by ase_grdpg().
}
\examples{
\dontrun{
# Generate latent positions on a 3D curve
generate_latent_curve <- function(n) {
  t_vals <- (1:n) / n
  X <- matrix(0, n, 3)
  X[, 1] <- 0.15 * sin(2 * pi * t_vals) + 0.6
  X[, 2] <- 0.15 * cos(2 * pi * t_vals) + 0.6
  X[, 3] <- 0.15 * cos(4 * pi * t_vals)
  return(X)
}

set.seed(1)
n <- 60; d <- 3; p_sig <- 2; q_sig <- 1; p_cov <- 4
X0 <- generate_latent_curve(n)
S <- diag(c(rep(1, p_sig), rep(-1, q_sig)))
P <- X0 \%*\% S \%*\% t(X0)
A <- matrix(rbinom(n*n, 1, as.vector(P)), n, n); A[lower.tri(A)] <- t(A)[lower.tri(A)]; diag(A) <- 0
Z0 <- matrix(rnorm(p_cov*d), p_cov, d)
B <- Z0 \%*\% t(X0) + matrix(rnorm(p_cov*n), p_cov, n)
fit <- fit_grdpg_cov(A, B, d = d, p = p_sig, q = q_sig, maxit = 3)
str(fit)
}
}
